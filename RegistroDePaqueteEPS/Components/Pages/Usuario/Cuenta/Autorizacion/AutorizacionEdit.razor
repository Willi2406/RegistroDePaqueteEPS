@page "/cuenta/autorizados/edit/{Id:int}"
@inject NavigationManager NavManager
@rendermode InteractiveServer

<SectionContent SectionName="TituloPagina">
    <h1>Cuenta : edictar autorizados para entrega</h1>
</SectionContent>

<div class="glass-container edit-authorized-view">

    <div class="sub-nav-bar">
        <NavLink class="sub-nav-item" href="/cuenta">Perfil</NavLink>
        <div class="separator"></div>

        <NavLink class="sub-nav-item" href="/cuenta/direcciones">Direcciones</NavLink>
        <div class="separator"></div>

        <NavLink class="sub-nav-item active" href="/cuenta/autorizados">Autorizados</NavLink>
    </div>

    <div class="form-content">
        <h3 class="section-title">Editar Persona Autorizada</h3>

        <EditForm Model="AutorizadoEditar" OnValidSubmit="GuardarCambios">
            <DataAnnotationsValidator />

            <div class="form-grid">
                <div class="input-group">
                    <label>Nombre Completo</label>
                    <InputText @bind-Value="AutorizadoEditar.Nombre" class="input-box" placeholder="Nombre y Apellido" />
                </div>
                <div class="input-group">
                    <label>Cédula</label>
                    <InputText @bind-Value="AutorizadoEditar.Cedula" class="input-box" placeholder="000-0000000-0" />
                </div>

                <div class="input-group">
                    <label>Parentesco</label>
                    <InputText @bind-Value="AutorizadoEditar.Parentesco" class="input-box" placeholder="Ej: Hermano, Esposa" />
                </div>
                <div class="input-group">
                    <label>Teléfono</label>
                    <InputText @bind-Value="AutorizadoEditar.Telefono" class="input-box" placeholder="809-000-0000" />
                </div>
            </div>

            <div class="options-row">
                <div class="checkbox-group">
                    <label class="switch">
                        <InputCheckbox @bind-Value="AutorizadoEditar.Activo" />
                        <span class="slider round"></span>
                    </label>
                    <span class="checkbox-label">Autorizado Activo</span>
                </div>
            </div>

            <div class="action-buttons">
                <button type="button" class="btn-cancel" @onclick="Cancelar">Cancelar</button>
                <button type="submit" class="btn-save">Guardar Cambios</button>
            </div>

        </EditForm>
    </div>

</div>

@code {
    [Parameter]
    public int Id { get; set; } // Recibimos el ID desde la URL

    // Modelo para el formulario
    public class AutorizadoForm
    {
        public int Id { get; set; }
        public string Nombre { get; set; }
        public string Cedula { get; set; }
        public string Parentesco { get; set; }
        public string Telefono { get; set; }
        public bool Activo { get; set; }
    }

    public AutorizadoForm AutorizadoEditar { get; set; } = new AutorizadoForm();

    protected override void OnInitialized()
    {
        // AQUÍ SIMULAMOS CARGAR LOS DATOS DE LA BASE DE DATOS USANDO EL ID
        // En tu código real sería: AutorizadoEditar = await servicio.Buscar(Id);

        if (Id > 0)
        {
            // Datos falsos para que veas cómo se ve lleno
            AutorizadoEditar = new AutorizadoForm
            {
                Id = Id,
                Nombre = "Maria Perez",
                Cedula = "402-1234567-8",
                Parentesco = "Esposa",
                Telefono = "809-555-1234",
                Activo = true
            };
        }
    }

    private void GuardarCambios()
    {
        // Aquí llamarías a: await autorizadosService.Modificar(AutorizadoEditar);

        // Redirigir a la lista
        NavManager.NavigateTo("/CuentaAdmin/autorizados");
    }

    private void Cancelar()
    {
        NavManager.NavigateTo("/CuentaAdmin/autorizados");
    }
}